const AWS = require('aws-sdk');
const secretsManager = new AWS.SecretsManager();

const getSecrets = async (keyName) => {
    try {
        // Store the SECRETS_NAMESPACE value from the Function's environment variables
        // Construct paramaters to pass to AWS Secrets Manager API call
        // SecretId is a combination of the secret's namespace and the specific secret to return
        // AWS Secrets Manager API call passing through params for retrieval
        const response = await secretsManager.getSecretValue({
            SecretId: process.env.SECRETS_NAMESPACE + keyName,
        }).promise();

        // Accessing the secret's value of the response object
        return JSON.parse(response.SecretString);
    } catch (exception) {
        throw exception;
    }
};

exports.getName = getName;
